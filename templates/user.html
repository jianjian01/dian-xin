{% extends "base.html" %}

{% block css %}
    <link rel="stylesheet" type="text/css" href="{{ static_url('css/user.css') }}">
{% endblock %}


{% block content %}
    <div class="main-container">
        <div class="content-body">
            <nav class="nav">
                <div class="sidebar">
                    <ul class="sidebar-ul">
                        <li class="{% if page=='info' %}active{% endif %}">
                            <a href="/user/{{ request.user.u_id }}">{{ _('personal_info') }}</a>
                        </li>
                        <li class="{% if page=='category' %}active{% endif %}">
                            <a href="/user/{{ request.user.u_id }}/category">{{ _('category') }}</a>
                        </li>
                        <li class="{% if page=='website' %}active{% endif %}">
                            <a href="/user/{{ request.user.u_id }}/website">{{ _('Web_site') }}</a>
                        </li>
                        <li class="{% if page=='rss' %}active{% endif %}">
                            <a href="/user/{{ request.user.u_id }}/rss">{{ _('rss_feed') }}</a>
                        </li>
                    </ul>
                </div>
            </nav>
            <main role="main">
                {% if page == 'info' %}
                    {% set user = request.user %}
                    <div class="form-container" id="main-user">
                        <form action="#">
                            <div class="form-row">
                                <label for="avatar_url">{{ _('avatar') }}</label>
                                <img width="100px" height="100px" alt="{{ user.name }}"
                                     src="{{ user.avatar_url }}"/>
                            </div>
                            <div class="form-row">
                                <label for="u_id">ID</label>
                                <input readonly id="u_id" class="main-input-display"
                                       value="{{ user.u_id }}" name="u_id">
                            </div>
                            <div class="form-row">
                                <label for="name">{{ _('name') }}</label>
                                <input readonly id="name" class="main-input-display"
                                       value="{{ user.name }}" name="name">
                            </div>
                            <div class="form-row">
                                <label for="source">{{ _('login_paltform') }}</label>
                                <input readonly id="source" class="main-input-display"
                                       value="{{ [0, 'GitHub', 'weibo'][user.source] }}" name="source">
                            </div>
                            <div class="form-row">
                                <label for="register-date">{{ _('register_date') }}</label>
                                <input readonly id="register-date" class="main-input-display"
                                       value="{{ user.create_time| string |truncate(10, False, end='') }}"
                                       name="register-date">
                            </div>
                            <div class="form-row">
                                <label></label>
                                <a href="/">
                                    <button type="button" role="button"
                                            class="btn btn-success btn-one">{{ _('backhome') }}</button>
                                </a>
                            </div>

                        </form>

                    </div>


                {% elif page == 'category' %}
                    <div class="form-container" id="main-category">
                        <table class="table">
                            <thead>
                            <tr>
                                <th scope="col" class="cate-num">#</th>
                                <th scope="col">{{ _('category') }}</th>
                                <th scope="col" class="large-order-cel">{{ _('serial_num') }}</th>
                                <th scope="col" class="cate-action">{{ _('action') }}</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for c in categories | sort(attribute="order") %}
                                <tr data-id="{{ c.id }}">
                                    <th scope="row">{{ loop.index }}</th>
                                    <td>{{ c.name }}</td>
                                    <td>{{ c.order }}</td>
                                    <td>
                                        <button type="button" class="delete-cate action-cate">{{ _('delete') }}</button>
                                        /
                                        <button type="button" class="update-cate action-cate">{{ _('update') }}</button>
                                    </td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                        <small class="small">
                            1. 序号 1 ～ 1000 之间，按照从小到大排列；
                        </small><br/>
                        <small class="small">
                            2. 一次只能添加一条数据；
                        </small><br/>
                        <small class="small">
                            3. 删除分类，则分类下的网址都会被隐藏。
                        </small>
                        <div class="btn-group">
                            <a href="/">
                                <button type="button" class="btn btn-success">{{ _('backhome') }}</button>
                            </a>
                            <button type="button" class="btn btn-light" id="btn-add-cate">{{ _('add') }}</button>

                        </div>
                    </div>

                {% elif page == 'website' %}
                    <div class="form-container" id="main-website">
                        {% if categories %}
                            {% for c in categories | sort(attribute="order") %}
                                <div class="site-list" data-id="{{ c.id }}">
                                    <div class="site-category-header">
                                        <span class="site-category-name">{{ c.name }}</span>
                                        <button type="button" class="add-new-website">{{ _('add') }}</button>
                                    </div>
                                    {% set ss = sites.get(c.id) %}
                                    <table class="site-table table">
                                        <thead>
                                        <tr>
                                            <th scope="col" class="site-num">#</th>
                                            <th scope="col" class="site-name">{{ _('name') }}</th>
                                            <th scope="col" class="site-url">{{ _('url') }}</th>
                                            <th scope="col" class="site-order">{{ _('serial_num') }}</th>
                                            <th scope="col" class="site-action">{{ _('action') }}</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% if ss %}
                                            {% for s in ss | sort(attribute="order") %}
                                                <tr data-id="{{ s.id }}" class="site-site">
                                                    <th scope="row" class="site-num">
                                                        {{ loop.index }}
                                                    </th>
                                                    <td class="site-name">
                                                        {{ s.name }}
                                                    </td>
                                                    <td class="site-url">
                                                        {{ s.url |truncate(50) }}
                                                    </td>
                                                    <td class="site-order">{{ s.order }}</td>
                                                    <td class="site-action">
                                                        <span class="delete-site">{{ _('update') }}</span>
                                                    </td>
                                                </tr>
                                            {% endfor %}
                                        {% endif %}
                                        </tbody>
                                    </table>
                                </div>
                            {% endfor %}
                        {% endif %}
                        <a href="/">
                            <button type="button" role="button"
                                    class="btn btn-success btn-one">{{ _('backhome') }}</button>
                        </a>
                    </div>
                {% elif page == 'rss' %}
                    <div class="form-container" id="main-rss">
                        <table class="table">
                            <thead>
                            <tr>
                                <th scope="col" class="site-num">#</th>
                                <th scope="col">{{ _('name') }}</th>
                                <th scope="col">{{ _('url') }}</th>
                                <th scope="col">{{ _('action') }}</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for s in user_rss %}
                                <tr data-id="{{ s[0] }}">
                                    <th scope="row" class="site-num">
                                        {{ loop.index }}
                                    </th>
                                    <td>
                                        {{ s[1] | truncate(20) }}
                                    </td>
                                    <td>
                                        {{ s[2] |truncate(50) }}
                                    </td>
                                    <td>
                                        <span class="delete-rss">{{ _('delete') }}</span>
                                    </td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                        <div class="btn-group">
                            <a href="/">
                                <button type="button" class="btn btn-success">{{ _('backhome') }}</button>
                            </a>
                            <button type="button" class="btn btn-light" id="btn-add-rss">{{ _('add') }}</button>
                        </div>
                    </div>

                {% endif %}
            </main>
        </div>
    </div>
{% endblock %}

{% block script %}
    {% if page == 'category' %}
        <script src="{{ static_url('js/user_category.js') }}"></script>
    {% elif page == 'website' %}
        <script src="{{ static_url('js/user_website.js') }}"></script>
    {% elif page == 'rss' %}
        <script src="{{ static_url('js/user_rss.js') }}"></script>

    {% endif %}
{% endblock %}
